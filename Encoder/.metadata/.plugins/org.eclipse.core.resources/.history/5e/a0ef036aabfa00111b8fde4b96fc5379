// File:         Delay.java
// Created:      9/3/2012
// Author:       Kevin Polulak <kpolulak@gmail.com>

package org.hak5.ducky.command;

import org.hak5.ducky.State;
import org.hak5.ducky.Command;

public final class Delay implements Command {
    public final java.lang.String name    = "DELAY";
    public final java.lang.String altName = "";
    public final java.lang.String help    = name + " [Time in millisecond * 10]";

    public void action(State state, java.lang.String args) {
        // XXX Could state.getCurrentInstruction() be replaced with args?
		int delay = Integer.parseInt(state.getCurrentInstruction().trim());

        while (delay > 0) {
            state.addByteToFile(0x00);

            if (delay > 255) {
                state.addByteToFile(0xFF);
                delay = delay - 255;
            } else {
                state.addByteToFile(delay);
                delay = 0;
            }
        }

        state.setDelayOverride(true);
    }
}